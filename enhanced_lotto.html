<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ ë¡œë˜ ë²ˆí˜¸ ìƒì„±ê¸° Pro v2.0 | ì €ì¥ & ë‹¹ì²¨ ì²´í¬</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #4F46E5;
            --primary-hover: #4338CA;
            --primary-light: #EEF2FF;
            --secondary: #06B6D4;
            --secondary-hover: #0891B2;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --dark: #1F2937;
            --gray-600: #4B5563;
            --gray-400: #9CA3AF;
            --gray-200: #E5E7EB;
            --gray-100: #F3F4F6;
            --white: #FFFFFF;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            --radius: 12px;
            --radius-sm: 8px;
            --radius-lg: 16px;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .main-header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 0.5s ease;
        }

        .main-header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .main-header p {
            color: var(--gray-600);
            font-size: 1.1rem;
        }

        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        @media (min-width: 768px) {
            .content-wrapper {
                grid-template-columns: 2fr 1fr;
            }
        }

        .card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 24px;
            box-shadow: var(--shadow-lg);
            animation: fadeIn 0.5s ease;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title .icon {
            width: 28px;
            height: 28px;
            background: var(--primary-light);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .input-group {
            display: flex;
            gap: 10px;
        }

        select, input[type="text"], input[type="password"], input[type="number"] {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-sm);
            font-size: 1rem;
            transition: all 0.3s;
            background: var(--white);
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }

        .btn:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover:before {
            width: 400px;
            height: 400px;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--secondary);
            color: var(--white);
        }

        .btn-secondary:hover {
            background: var(--secondary-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: var(--success);
            color: var(--white);
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-outline {
            background: var(--white);
            border: 2px solid var(--gray-200);
            color: var(--dark);
        }

        .btn-outline:hover {
            background: var(--gray-100);
            border-color: var(--gray-400);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .lotto-display {
            margin-top: 30px;
        }

        .lotto-set {
            background: var(--gray-100);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s;
            animation: slideIn 0.5s ease;
        }

        .lotto-set:hover {
            background: var(--gray-200);
            transform: translateX(5px);
        }

        .lotto-set-number {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.1rem;
            min-width: 35px;
        }

        .lotto-balls {
            display: flex;
            gap: 8px;
            flex: 1;
        }

        .lotto-ball {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--white);
            font-size: 1.15rem;
            position: relative;
            animation: bounce 0.5s ease;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .lotto-ball:after {
            content: '';
            position: absolute;
            top: 5px;
            left: 8px;
            width: 12px;
            height: 12px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            filter: blur(2px);
        }

        /* ë¡œë˜ ë²ˆí˜¸ êµ¬ê°„ë³„ ìƒ‰ìƒ - ì‹¤ì œ ë¡œë˜ ìƒ‰ìƒê³¼ ìœ ì‚¬í•˜ê²Œ */
        .ball-yellow { 
            background: linear-gradient(135deg, #FFC107 0%, #FF9800 100%); 
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.4);
        }
        .ball-blue { 
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%); 
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
        }
        .ball-red { 
            background: linear-gradient(135deg, #F44336 0%, #D32F2F 100%); 
            box-shadow: 0 4px 12px rgba(244, 67, 54, 0.4);
        }
        .ball-gray { 
            background: linear-gradient(135deg, #757575 0%, #424242 100%); 
            box-shadow: 0 4px 12px rgba(117, 117, 117, 0.4);
        }
        .ball-green { 
            background: linear-gradient(135deg, #4CAF50 0%, #388E3C 100%); 
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
        }

        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            background: var(--gray-100);
            padding: 5px;
            border-radius: var(--radius);
        }

        .tab {
            flex: 1;
            padding: 10px;
            border: none;
            background: transparent;
            color: var(--gray-600);
            font-weight: 600;
            cursor: pointer;
            border-radius: var(--radius-sm);
            transition: all 0.3s;
        }

        .tab.active {
            background: var(--white);
            color: var(--primary);
            box-shadow: var(--shadow-sm);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .check-result {
            margin-top: 20px;
            padding: 20px;
            background: var(--primary-light);
            border-radius: var(--radius);
            border: 2px solid var(--primary);
        }

        .check-result h4 {
            color: var(--primary);
            margin-bottom: 15px;
        }

        .result-item {
            padding: 10px;
            background: var(--white);
            border-radius: var(--radius-sm);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .result-rank {
            font-weight: 700;
            padding: 5px 12px;
            border-radius: 20px;
            color: var(--white);
        }

        .rank-1 { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .rank-2 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .rank-3 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .rank-4 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .rank-5 { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }

        .loading {
            text-align: center;
            padding: 20px;
            color: var(--gray-600);
        }

        .spinner {
            border: 3px solid var(--gray-200);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        .alert {
            padding: 12px 16px;
            border-radius: var(--radius-sm);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-info {
            background: var(--primary-light);
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .alert-success {
            background: #ECFDF5;
            color: var(--success);
            border: 1px solid var(--success);
        }

        .alert-error {
            background: #FEF2F2;
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .saved-sets-list {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .saved-set-item {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-sm);
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .saved-set-item:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow);
        }

        .saved-set-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .saved-set-round {
            font-weight: 700;
            color: var(--primary);
        }

        .saved-set-date {
            color: var(--gray-400);
            font-size: 0.9rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--white);
            padding: 30px;
            border-radius: var(--radius-lg);
            max-width: 500px;
            width: 90%;
            animation: slideIn 0.3s ease;
        }

        .modal-header {
            margin-bottom: 20px;
        }

        .modal-header h3 {
            color: var(--dark);
            font-size: 1.5rem;
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        @media print {
            body {
                background: white;
            }
            .card {
                box-shadow: none;
                border: 1px solid var(--gray-200);
            }
            .btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="main-header">
            <h1>ğŸ¯ ë¡œë˜ ë²ˆí˜¸ ìƒì„±ê¸° Pro</h1>
            <p>ìŠ¤ë§ˆíŠ¸í•œ ë²ˆí˜¸ ìƒì„±, ì €ì¥, ë‹¹ì²¨ ì²´í¬ê¹Œì§€ í•œë²ˆì—!</p>
        </header>

        <div class="content-wrapper">
            <!-- ë©”ì¸ íŒ¨ë„ -->
            <div class="card">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('generate')">âš¡ ë²ˆí˜¸ ìƒì„±</button>
                    <button class="tab" onclick="switchTab('saved')">ğŸ’¾ ì €ì¥ ê´€ë¦¬</button>
                    <button class="tab" onclick="switchTab('check')">ğŸ† ë‹¹ì²¨ ì²´í¬</button>
                </div>

                <!-- ë²ˆí˜¸ ìƒì„± íƒ­ -->
                <div id="generate-tab" class="tab-content active">
                    <div class="card-title">
                        <div class="icon">âš¡</div>
                        <span>ë¡œë˜ ë²ˆí˜¸ ìƒì„±</span>
                    </div>

                    <div class="control-group">
                        <label for="count-select">ìƒì„±í•  ì¡°í•© ìˆ˜</label>
                        <div class="input-group">
                            <select id="count-select">
                                <option value="5">5ê°œ ì¡°í•©</option>
                                <option value="10">10ê°œ ì¡°í•©</option>
                                <option value="20">20ê°œ ì¡°í•©</option>
                                <option value="30">30ê°œ ì¡°í•©</option>
                                <option value="50">50ê°œ ì¡°í•©</option>
                                <option value="100">100ê°œ ì¡°í•©</option>
                            </select>
                        </div>
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="generateNumbers()">
                            <span>ğŸ²</span> ë²ˆí˜¸ ìƒì„±
                        </button>
                        <button class="btn btn-secondary" onclick="saveToGitHub()" id="save-btn" disabled>
                            <span>ğŸ’¾</span> GitHub ì €ì¥
                        </button>
                        <button class="btn btn-outline" onclick="exportPDF()" id="pdf-btn" disabled>
                            <span>ğŸ“„</span> PDF ë‹¤ìš´ë¡œë“œ
                        </button>
                    </div>

                    <div id="loading-msg" class="loading" style="display: none;">
                        <div class="spinner"></div>
                        <p>ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤...</p>
                    </div>

                    <div id="generated-numbers" class="lotto-display"></div>
                </div>

                <!-- ì €ì¥ ê´€ë¦¬ íƒ­ -->
                <div id="saved-tab" class="tab-content">
                    <div class="card-title">
                        <div class="icon">ğŸ’¾</div>
                        <span>ì €ì¥ëœ ë²ˆí˜¸ ê´€ë¦¬</span>
                    </div>

                    <div class="control-group">
                        <label>GitHub ì„¤ì •</label>
                        <input type="text" id="github-token" placeholder="GitHub Personal Access Token" style="margin-bottom: 10px;">
                        <div class="input-group">
                            <input type="text" id="github-owner" placeholder="ì‚¬ìš©ìëª… (ì˜ˆ: nagashino2014)" value="nagashino2014">
                            <input type="text" id="github-repo" placeholder="ì €ì¥ì†Œëª… (ì˜ˆ: Lotto)" value="Lotto">
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="loadSavedSets()">
                        <span>ğŸ”„</span> ì €ì¥ëœ ë²ˆí˜¸ ë¶ˆëŸ¬ì˜¤ê¸°
                    </button>

                    <div id="saved-sets" class="saved-sets-list" style="margin-top: 20px;"></div>
                </div>

                <!-- ë‹¹ì²¨ ì²´í¬ íƒ­ -->
                <div id="check-tab" class="tab-content">
                    <div class="card-title">
                        <div class="icon">ğŸ†</div>
                        <span>ë‹¹ì²¨ ë²ˆí˜¸ í™•ì¸</span>
                    </div>

                    <div class="control-group">
                        <label for="check-round">í™•ì¸í•  íšŒì°¨ ë²ˆí˜¸</label>
                        <input type="number" id="check-round" placeholder="ì˜ˆ: 1196" min="1">
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="checkWinning()">
                            <span>ğŸ”</span> ë‹¹ì²¨ í™•ì¸
                        </button>
                        <button class="btn btn-secondary" onclick="getLatestRound()">
                            <span>ğŸ“Š</span> ìµœì‹  íšŒì°¨ ì¡°íšŒ
                        </button>
                    </div>

                    <div id="winning-numbers" style="margin-top: 20px;"></div>
                    <div id="check-results"></div>
                </div>
            </div>

            <!-- ì‚¬ì´ë“œ íŒ¨ë„ -->
            <div>
                <!-- í†µê³„ ì¹´ë“œ -->
                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-title">
                        <div class="icon">ğŸ“Š</div>
                        <span>ì˜¤ëŠ˜ì˜ í†µê³„</span>
                    </div>
                    <div id="statistics">
                        <p style="color: var(--gray-600); margin-bottom: 10px;">ìƒì„±ëœ ì¡°í•©: <strong id="total-generated">0</strong>ê°œ</p>
                        <p style="color: var(--gray-600); margin-bottom: 10px;">ì €ì¥ëœ íšŒì°¨: <strong id="total-saved">0</strong>íšŒ</p>
                        <p style="color: var(--gray-600);">ë‹¹ì²¨ í™•ì¸: <strong id="total-checked">0</strong>íšŒ</p>
                    </div>
                </div>

                <!-- ë²ˆí˜¸ ìƒ‰ìƒ ë²”ë¡€ -->
                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-title">
                        <div class="icon">ğŸ¨</div>
                        <span>ë²ˆí˜¸ êµ¬ê°„ ìƒ‰ìƒ</span>
                    </div>
                    <div style="font-size: 0.9rem;">
                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                            <div class="lotto-ball ball-yellow" style="width: 32px; height: 32px; font-size: 0.85rem; margin-right: 10px;">10</div>
                            <span style="color: var(--gray-600);">1 ~ 10</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                            <div class="lotto-ball ball-blue" style="width: 32px; height: 32px; font-size: 0.85rem; margin-right: 10px;">20</div>
                            <span style="color: var(--gray-600);">11 ~ 20</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                            <div class="lotto-ball ball-red" style="width: 32px; height: 32px; font-size: 0.85rem; margin-right: 10px;">30</div>
                            <span style="color: var(--gray-600);">21 ~ 30</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                            <div class="lotto-ball ball-gray" style="width: 32px; height: 32px; font-size: 0.85rem; margin-right: 10px;">40</div>
                            <span style="color: var(--gray-600);">31 ~ 40</span>
                        </div>
                        <div style="display: flex; align-items: center;">
                            <div class="lotto-ball ball-green" style="width: 32px; height: 32px; font-size: 0.85rem; margin-right: 10px;">45</div>
                            <span style="color: var(--gray-600);">41 ~ 45</span>
                        </div>
                    </div>
                </div>

                <!-- ë‹¹ì²¨ ì¡°ê±´ ì•ˆë‚´ -->
                <div class="card">
                    <div class="card-title">
                        <div class="icon">â„¹ï¸</div>
                        <span>ë‹¹ì²¨ ì¡°ê±´</span>
                    </div>
                    <div style="font-size: 0.9rem; color: var(--gray-600);">
                        <div style="margin-bottom: 8px;">
                            <span class="result-rank rank-1">1ë“±</span> 6ê°œ ë²ˆí˜¸ ì¼ì¹˜
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span class="result-rank rank-2">2ë“±</span> 5ê°œ + ë³´ë„ˆìŠ¤
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span class="result-rank rank-3">3ë“±</span> 5ê°œ ë²ˆí˜¸ ì¼ì¹˜
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span class="result-rank rank-4">4ë“±</span> 4ê°œ ë²ˆí˜¸ ì¼ì¹˜
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span class="result-rank rank-5">5ë“±</span> 3ê°œ ë²ˆí˜¸ ì¼ì¹˜
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ëª¨ë‹¬ -->
    <div id="saveModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ë²ˆí˜¸ ì €ì¥í•˜ê¸°</h3>
            </div>
            <div class="modal-body">
                <div class="control-group">
                    <label for="save-round">ë¡œë˜ íšŒì°¨ ì…ë ¥</label>
                    <input type="number" id="save-round" placeholder="ì˜ˆ: 1196" min="1">
                </div>
                <div class="control-group">
                    <label for="save-memo">ë©”ëª¨ (ì„ íƒ)</label>
                    <input type="text" id="save-memo" placeholder="ì˜ˆ: ìƒì¼ ì¡°í•©">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="confirmSave()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <script>
        // jsPDF ì„¤ì •
        const { jsPDF } = window.jspdf;
        
        // ì „ì—­ ë³€ìˆ˜
        let currentNumbers = [];
        let savedSets = [];
        let statistics = {
            generated: 0,
            saved: 0,
            checked: 0
        };

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            // ëª¨ë“  íƒ­ê³¼ ì»¨í…ì¸  ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            event.target.classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }

        // ë²ˆí˜¸ ìƒì„± í•¨ìˆ˜
        function generateNumbers() {
            const count = parseInt(document.getElementById('count-select').value);
            currentNumbers = [];
            
            for (let i = 0; i < count; i++) {
                const numbers = new Set();
                while (numbers.size < 6) {
                    numbers.add(Math.floor(Math.random() * 45) + 1);
                }
                currentNumbers.push(Array.from(numbers).sort((a, b) => a - b));
            }
            
            displayNumbers(currentNumbers);
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            statistics.generated += count;
            updateStatistics();
            
            // ë²„íŠ¼ í™œì„±í™”
            document.getElementById('save-btn').disabled = false;
            document.getElementById('pdf-btn').disabled = false;
        }

        // ë²ˆí˜¸ í‘œì‹œ í•¨ìˆ˜
        function displayNumbers(numbers) {
            const container = document.getElementById('generated-numbers');
            container.innerHTML = '';
            
            numbers.forEach((set, index) => {
                const setDiv = document.createElement('div');
                setDiv.className = 'lotto-set';
                
                const numberDiv = document.createElement('div');
                numberDiv.className = 'lotto-set-number';
                numberDiv.textContent = `${(index + 1).toString().padStart(2, '0')}.`;
                
                const ballsDiv = document.createElement('div');
                ballsDiv.className = 'lotto-balls';
                
                set.forEach(num => {
                    const ball = document.createElement('div');
                    
                    // ë²ˆí˜¸ êµ¬ê°„ë³„ ìƒ‰ìƒ í´ë˜ìŠ¤ ì ìš©
                    let colorClass = '';
                    if (num >= 1 && num <= 10) {
                        colorClass = 'ball-yellow';  // 1-10: ë…¸ë€ìƒ‰
                    } else if (num >= 11 && num <= 20) {
                        colorClass = 'ball-blue';     // 11-20: íŒŒë€ìƒ‰
                    } else if (num >= 21 && num <= 30) {
                        colorClass = 'ball-red';      // 21-30: ë¹¨ê°„ìƒ‰
                    } else if (num >= 31 && num <= 40) {
                        colorClass = 'ball-gray';     // 31-40: íšŒìƒ‰
                    } else if (num >= 41 && num <= 45) {
                        colorClass = 'ball-green';    // 41-45: ì´ˆë¡ìƒ‰
                    }
                    
                    ball.className = `lotto-ball ${colorClass}`;
                    ball.textContent = num;
                    ballsDiv.appendChild(ball);
                });
                
                setDiv.appendChild(numberDiv);
                setDiv.appendChild(ballsDiv);
                container.appendChild(setDiv);
            });
        }

        // GitHub ì €ì¥ í•¨ìˆ˜
        function saveToGitHub() {
            const modal = document.getElementById('saveModal');
            modal.classList.add('active');
        }

        function closeModal() {
            const modal = document.getElementById('saveModal');
            modal.classList.remove('active');
        }

        async function confirmSave() {
            const round = document.getElementById('save-round').value;
            const memo = document.getElementById('save-memo').value;
            const token = document.getElementById('github-token').value;
            const owner = document.getElementById('github-owner').value || 'nagashino2014';
            const repo = document.getElementById('github-repo').value || 'Lotto';
            
            if (!round) {
                alert('íšŒì°¨ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!token) {
                alert('GitHub Personal Access Tokenì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\nì„¤ì • > ê°œë°œì ì„¤ì • > Personal access tokensì—ì„œ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            const data = {
                round: parseInt(round),
                date: new Date().toISOString(),
                memo: memo,
                numbers: currentNumbers
            };
            
            const filename = `lotto_${round}_${Date.now()}.json`;
            const content = btoa(unescape(encodeURIComponent(JSON.stringify(data, null, 2))));
            
            try {
                const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${filename}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${token}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: `Add lotto numbers for round ${round}`,
                        content: content
                    })
                });
                
                if (response.ok) {
                    alert(`${round}íšŒì°¨ ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!`);
                    statistics.saved++;
                    updateStatistics();
                    closeModal();
                } else {
                    const error = await response.json();
                    alert(`ì €ì¥ ì‹¤íŒ¨: ${error.message}`);
                }
            } catch (error) {
                alert(`ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`);
            }
        }

        // ì €ì¥ëœ ë²ˆí˜¸ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadSavedSets() {
            const token = document.getElementById('github-token').value;
            const owner = document.getElementById('github-owner').value || 'nagashino2014';
            const repo = document.getElementById('github-repo').value || 'Lotto';
            
            if (!token) {
                alert('GitHub Personal Access Tokenì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/`, {
                    headers: {
                        'Authorization': `token ${token}`,
                    }
                });
                
                if (response.ok) {
                    const files = await response.json();
                    const lottoFiles = files.filter(file => file.name.startsWith('lotto_'));
                    
                    const container = document.getElementById('saved-sets');
                    container.innerHTML = '';
                    
                    for (const file of lottoFiles) {
                        const contentResponse = await fetch(file.download_url);
                        const data = await contentResponse.json();
                        
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'saved-set-item';
                        itemDiv.onclick = () => displaySavedSet(data);
                        
                        const headerDiv = document.createElement('div');
                        headerDiv.className = 'saved-set-header';
                        
                        const roundSpan = document.createElement('span');
                        roundSpan.className = 'saved-set-round';
                        roundSpan.textContent = `${data.round}íšŒì°¨`;
                        
                        const dateSpan = document.createElement('span');
                        dateSpan.className = 'saved-set-date';
                        dateSpan.textContent = new Date(data.date).toLocaleDateString();
                        
                        headerDiv.appendChild(roundSpan);
                        headerDiv.appendChild(dateSpan);
                        
                        if (data.memo) {
                            const memoDiv = document.createElement('div');
                            memoDiv.style.color = 'var(--gray-600)';
                            memoDiv.style.fontSize = '0.9rem';
                            memoDiv.textContent = data.memo;
                            itemDiv.appendChild(memoDiv);
                        }
                        
                        itemDiv.appendChild(headerDiv);
                        container.appendChild(itemDiv);
                    }
                    
                    if (lottoFiles.length === 0) {
                        container.innerHTML = '<p style="color: var(--gray-400); text-align: center;">ì €ì¥ëœ ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                    }
                } else {
                    alert('ì €ì¥ëœ ë²ˆí˜¸ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                alert(`ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`);
            }
        }

        // ì €ì¥ëœ ë²ˆí˜¸ í‘œì‹œ
        function displaySavedSet(data) {
            currentNumbers = data.numbers;
            switchTab('generate');
            displayNumbers(currentNumbers);
            
            // ì •ë³´ í‘œì‹œ
            const container = document.getElementById('generated-numbers');
            const infoDiv = document.createElement('div');
            infoDiv.className = 'alert alert-info';
            infoDiv.innerHTML = `<span>â„¹ï¸</span> ${data.round}íšŒì°¨ ì €ì¥ëœ ë²ˆí˜¸ (${new Date(data.date).toLocaleDateString()})`;
            container.insertBefore(infoDiv, container.firstChild);
        }

        // ë‹¹ì²¨ í™•ì¸ í•¨ìˆ˜
        async function checkWinning() {
            const round = document.getElementById('check-round').value;
            
            if (!round) {
                alert('í™•ì¸í•  íšŒì°¨ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (currentNumbers.length === 0) {
                alert('ë¨¼ì € ë²ˆí˜¸ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ì €ì¥ëœ ë²ˆí˜¸ë¥¼ ë¶ˆëŸ¬ì™€ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                // ë™í–‰ë³µê¶Œ API í”„ë¡ì‹œ ì„œë²„ë¥¼ í†µí•´ ë‹¹ì²¨ ë²ˆí˜¸ ì¡°íšŒ
                // ì‹¤ì œ êµ¬í˜„ì‹œ CORS ë¬¸ì œë¡œ ì¸í•´ ë°±ì—”ë“œ í”„ë¡ì‹œ ì„œë²„ê°€ í•„ìš”í•©ë‹ˆë‹¤
                const winningData = await fetchWinningNumbers(round);
                
                if (winningData) {
                    displayWinningNumbers(winningData);
                    checkResults(winningData);
                    statistics.checked++;
                    updateStatistics();
                }
            } catch (error) {
                alert(`ë‹¹ì²¨ ë²ˆí˜¸ë¥¼ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${error.message}`);
            }
        }

        // ë‹¹ì²¨ ë²ˆí˜¸ ì¡°íšŒ (ì˜ˆì‹œ ë°ì´í„°)
        async function fetchWinningNumbers(round) {
            // ì‹¤ì œ êµ¬í˜„ì‹œ ë°±ì—”ë“œ APIë¥¼ í†µí•´ ë™í–‰ë³µê¶Œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤
            // ì—¬ê¸°ì„œëŠ” ì˜ˆì‹œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤
            
            // ì˜ˆì‹œ: 1196íšŒì°¨ ë‹¹ì²¨ë²ˆí˜¸
            if (round === '1196') {
                return {
                    round: 1196,
                    date: '2024-11-02',
                    numbers: [8, 12, 15, 29, 40, 45],
                    bonus: 14,
                    prize: {
                        1: { count: 15, amount: 2001627550 },
                        2: { count: 75, amount: 66720919 },
                        3: { count: 2851, amount: 1755103 },
                        4: { count: 138949, amount: 50000 },
                        5: { count: 2265184, amount: 5000 }
                    }
                };
            }
            
            // ì„ì˜ì˜ ë‹¹ì²¨ ë²ˆí˜¸ ìƒì„± (í…ŒìŠ¤íŠ¸ìš©)
            const numbers = new Set();
            while (numbers.size < 6) {
                numbers.add(Math.floor(Math.random() * 45) + 1);
            }
            const bonus = Math.floor(Math.random() * 45) + 1;
            
            return {
                round: parseInt(round),
                date: new Date().toISOString().split('T')[0],
                numbers: Array.from(numbers).sort((a, b) => a - b),
                bonus: bonus,
                prize: {
                    1: { count: Math.floor(Math.random() * 20) + 1, amount: 2000000000 },
                    2: { count: Math.floor(Math.random() * 100) + 10, amount: 60000000 },
                    3: { count: Math.floor(Math.random() * 3000) + 1000, amount: 1500000 },
                    4: { count: Math.floor(Math.random() * 150000) + 100000, amount: 50000 },
                    5: { count: Math.floor(Math.random() * 2500000) + 2000000, amount: 5000 }
                }
            };
        }

        // ë‹¹ì²¨ ë²ˆí˜¸ í‘œì‹œ
        function displayWinningNumbers(data) {
            const container = document.getElementById('winning-numbers');
            
            // ë²ˆí˜¸ë³„ ìƒ‰ìƒ í´ë˜ìŠ¤ ê²°ì • í•¨ìˆ˜
            function getBallColorClass(num) {
                if (num >= 1 && num <= 10) return 'ball-yellow';
                if (num >= 11 && num <= 20) return 'ball-blue';
                if (num >= 21 && num <= 30) return 'ball-red';
                if (num >= 31 && num <= 40) return 'ball-gray';
                if (num >= 41 && num <= 45) return 'ball-green';
                return '';
            }
            
            container.innerHTML = `
                <div class="alert alert-info">
                    <span>ğŸ¯</span>
                    <div>
                        <strong>${data.round}íšŒì°¨ ë‹¹ì²¨ ë²ˆí˜¸</strong> (${data.date})
                        <div style="margin-top: 10px;">
                            <div class="lotto-balls" style="display: inline-flex;">
                                ${data.numbers.map(num => `
                                    <div class="lotto-ball ${getBallColorClass(num)}">${num}</div>
                                `).join('')}
                                <div style="margin: 0 10px; display: flex; align-items: center;">+</div>
                                <div class="lotto-ball ${getBallColorClass(data.bonus)}" style="position: relative;">
                                    ${data.bonus}
                                    <div style="position: absolute; top: -5px; right: -5px; background: #FFD700; color: #000; font-size: 10px; padding: 2px 4px; border-radius: 4px; font-weight: bold;">B</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ë‹¹ì²¨ ê²°ê³¼ í™•ì¸
        function checkResults(winningData) {
            const results = [];
            
            currentNumbers.forEach((myNumbers, index) => {
                const matchCount = myNumbers.filter(num => winningData.numbers.includes(num)).length;
                const bonusMatch = myNumbers.includes(winningData.bonus);
                
                let rank = 0;
                if (matchCount === 6) {
                    rank = 1;
                } else if (matchCount === 5 && bonusMatch) {
                    rank = 2;
                } else if (matchCount === 5) {
                    rank = 3;
                } else if (matchCount === 4) {
                    rank = 4;
                } else if (matchCount === 3) {
                    rank = 5;
                }
                
                if (rank > 0) {
                    results.push({
                        index: index + 1,
                        numbers: myNumbers,
                        rank: rank,
                        matchCount: matchCount,
                        bonusMatch: bonusMatch
                    });
                }
            });
            
            displayCheckResults(results, winningData);
        }

        // ë‹¹ì²¨ ê²°ê³¼ í‘œì‹œ
        function displayCheckResults(results, winningData) {
            const container = document.getElementById('check-results');
            
            if (results.length === 0) {
                container.innerHTML = `
                    <div class="alert alert-error">
                        <span>ğŸ˜”</span>
                        <div>ì•„ì‰½ê²Œë„ ë‹¹ì²¨ëœ ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ìŒ ê¸°íšŒì—!</div>
                    </div>
                `;
            } else {
                const rankNames = ['', '1ë“±', '2ë“±', '3ë“±', '4ë“±', '5ë“±'];
                const totalPrize = results.reduce((sum, r) => sum + (winningData.prize[r.rank]?.amount || 0), 0);
                
                container.innerHTML = `
                    <div class="check-result">
                        <h4>ğŸŠ ì¶•í•˜í•©ë‹ˆë‹¤! ${results.length}ê°œ ì¡°í•© ë‹¹ì²¨!</h4>
                        <div style="margin-bottom: 15px; color: var(--primary); font-size: 1.2rem; font-weight: 700;">
                            ì˜ˆìƒ ë‹¹ì²¨ê¸ˆ: ${totalPrize.toLocaleString()}ì›
                        </div>
                        ${results.map(r => `
                            <div class="result-item">
                                <div>
                                    <strong>${r.index}ë²ˆ ì¡°í•©:</strong> 
                                    ${r.numbers.join(', ')}
                                </div>
                                <span class="result-rank rank-${r.rank}">${rankNames[r.rank]}</span>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
        }

        // ìµœì‹  íšŒì°¨ ì¡°íšŒ
        async function getLatestRound() {
            // ì‹¤ì œë¡œëŠ” APIë¥¼ í†µí•´ ìµœì‹  íšŒì°¨ë¥¼ ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤
            const today = new Date();
            const firstLotto = new Date('2002-12-07');
            const weeksPassed = Math.floor((today - firstLotto) / (7 * 24 * 60 * 60 * 1000));
            const latestRound = weeksPassed + 1;
            
            document.getElementById('check-round').value = latestRound;
            
            const container = document.getElementById('winning-numbers');
            container.innerHTML = `
                <div class="alert alert-success">
                    <span>âœ…</span>
                    <div>ìµœì‹  íšŒì°¨ëŠ” ì•½ ${latestRound}íšŒì°¨ì…ë‹ˆë‹¤.</div>
                </div>
            `;
        }

        // PDF ë‚´ë³´ë‚´ê¸°
        async function exportPDF() {
            if (currentNumbers.length === 0) {
                alert('ë¨¼ì € ë²ˆí˜¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const doc = new jsPDF();
            
            // í°íŠ¸ ì„¤ì • (í•œê¸€ ì§€ì›ì„ ìœ„í•´ ì‹¤ì œë¡œëŠ” í•œê¸€ í°íŠ¸ ì¶”ê°€ í•„ìš”)
            doc.setFont('helvetica');
            
            // ì œëª©
            doc.setFontSize(20);
            doc.text('Lotto Numbers', 105, 20, { align: 'center' });
            
            // ë‚ ì§œ
            doc.setFontSize(12);
            doc.text(`Generated: ${new Date().toLocaleDateString()}`, 105, 30, { align: 'center' });
            
            // ë²ˆí˜¸ ì¶œë ¥
            doc.setFontSize(14);
            let yPos = 50;
            
            currentNumbers.forEach((numbers, index) => {
                const text = `${(index + 1).toString().padStart(2, '0')}.  ${numbers.map(n => n.toString().padStart(2, '0')).join('  ')}`;
                doc.text(text, 30, yPos);
                yPos += 10;
                
                if (yPos > 270) {
                    doc.addPage();
                    yPos = 30;
                }
            });
            
            // ì €ì¥
            doc.save('lotto_numbers.pdf');
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStatistics() {
            document.getElementById('total-generated').textContent = statistics.generated;
            document.getElementById('total-saved').textContent = statistics.saved;
            document.getElementById('total-checked').textContent = statistics.checked;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.onload = function() {
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
            const savedToken = localStorage.getItem('github-token');
            const savedOwner = localStorage.getItem('github-owner');
            const savedRepo = localStorage.getItem('github-repo');
            
            if (savedToken) document.getElementById('github-token').value = savedToken;
            if (savedOwner) document.getElementById('github-owner').value = savedOwner;
            if (savedRepo) document.getElementById('github-repo').value = savedRepo;
            
            // ì„¤ì • ì €ì¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('github-token').addEventListener('change', (e) => {
                localStorage.setItem('github-token', e.target.value);
            });
            document.getElementById('github-owner').addEventListener('change', (e) => {
                localStorage.setItem('github-owner', e.target.value);
            });
            document.getElementById('github-repo').addEventListener('change', (e) => {
                localStorage.setItem('github-repo', e.target.value);
            });
            
            updateStatistics();
        };
    </script>
</body>
</html>