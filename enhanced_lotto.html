<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ ë¡œë˜ ë²ˆí˜¸ ìƒì„±ê¸° Pro v2.0 | ì €ì¥ & ë‹¹ì²¨ ì²´í¬</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #4F46E5;
            --primary-hover: #4338CA;
            --primary-light: #EEF2FF;
            --secondary: #06B6D4;
            --secondary-hover: #0891B2;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --dark: #1F2937;
            --gray-600: #4B5563;
            --gray-400: #9CA3AF;
            --gray-200: #E5E7EB;
            --gray-100: #F3F4F6;
            --white: #FFFFFF;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            --radius: 12px;
            --radius-sm: 8px;
            --radius-lg: 16px;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .main-header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 0.5s ease;
        }

        .main-header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .main-header p {
            color: var(--gray-600);
            font-size: 1.1rem;
        }

        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        @media (min-width: 768px) {
            .content-wrapper {
                grid-template-columns: 2fr 1fr;
            }
        }

        .card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: 24px;
            box-shadow: var(--shadow-lg);
            animation: fadeIn 0.5s ease;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title .icon {
            width: 28px;
            height: 28px;
            background: var(--primary-light);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .input-group {
            display: flex;
            gap: 10px;
        }

        select, input[type="text"], input[type="password"], input[type="number"] {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-sm);
            font-size: 1rem;
            transition: all 0.3s;
            background: var(--white);
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }

        .btn:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover:before {
            width: 400px;
            height: 400px;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--secondary);
            color: var(--white);
        }

        .btn-secondary:hover {
            background: var(--secondary-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: var(--success);
            color: var(--white);
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-outline {
            background: var(--white);
            border: 2px solid var(--gray-200);
            color: var(--dark);
        }

        .btn-outline:hover {
            background: var(--gray-100);
            border-color: var(--gray-400);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .lotto-display {
            margin-top: 30px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        @media (max-width: 768px) {
            .lotto-display {
                grid-template-columns: 1fr;
            }
        }

        .lotto-card {
            background: var(--white);
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 20px;
            box-shadow: var(--shadow);
            transition: all 0.3s;
            animation: slideIn 0.5s ease;
        }

        .lotto-card:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        .lotto-card-title {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.1rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-light);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .lotto-set {
            background: var(--gray-100);
            border-radius: var(--radius);
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s;
        }

        .lotto-set:hover {
            background: var(--gray-200);
        }

        .lotto-set:last-child {
            margin-bottom: 0;
        }

        .lotto-set-number {
            font-weight: 700;
            color: var(--primary);
            font-size: 0.95rem;
            min-width: 30px;
        }

        .lotto-balls {
            display: flex;
            gap: 8px;
            flex: 1;
        }

        .lotto-ball {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--white);
            font-size: 1.15rem;
            position: relative;
            animation: bounce 0.5s ease;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .lotto-ball:after {
            content: '';
            position: absolute;
            top: 5px;
            left: 8px;
            width: 12px;
            height: 12px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            filter: blur(2px);
        }

        /* ë¡œë˜ ë²ˆí˜¸ êµ¬ê°„ë³„ ìƒ‰ìƒ - ì‹¤ì œ ë¡œë˜ ìƒ‰ìƒê³¼ ìœ ì‚¬í•˜ê²Œ */
        .ball-yellow { 
            background: linear-gradient(135deg, #FFC107 0%, #FF9800 100%); 
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.4);
        }
        .ball-blue { 
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%); 
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
        }
        .ball-red { 
            background: linear-gradient(135deg, #F44336 0%, #D32F2F 100%); 
            box-shadow: 0 4px 12px rgba(244, 67, 54, 0.4);
        }
        .ball-gray { 
            background: linear-gradient(135deg, #757575 0%, #424242 100%); 
            box-shadow: 0 4px 12px rgba(117, 117, 117, 0.4);
        }
        .ball-green { 
            background: linear-gradient(135deg, #4CAF50 0%, #388E3C 100%); 
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
        }

        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            background: var(--gray-100);
            padding: 5px;
            border-radius: var(--radius);
        }

        .tab {
            flex: 1;
            padding: 10px;
            border: none;
            background: transparent;
            color: var(--gray-600);
            font-weight: 600;
            cursor: pointer;
            border-radius: var(--radius-sm);
            transition: all 0.3s;
        }

        .tab.active {
            background: var(--white);
            color: var(--primary);
            box-shadow: var(--shadow-sm);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .check-result {
            margin-top: 20px;
            padding: 20px;
            background: var(--primary-light);
            border-radius: var(--radius);
            border: 2px solid var(--primary);
        }

        .check-result h4 {
            color: var(--primary);
            margin-bottom: 15px;
        }

        .result-item {
            padding: 10px;
            background: var(--white);
            border-radius: var(--radius-sm);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .result-rank {
            font-weight: 700;
            padding: 5px 12px;
            border-radius: 20px;
            color: var(--white);
        }

        .rank-1 { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .rank-2 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .rank-3 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .rank-4 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .rank-5 { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }

        .loading {
            text-align: center;
            padding: 20px;
            color: var(--gray-600);
        }

        .spinner {
            border: 3px solid var(--gray-200);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        .alert {
            padding: 12px 16px;
            border-radius: var(--radius-sm);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-info {
            background: var(--primary-light);
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .alert-success {
            background: #ECFDF5;
            color: var(--success);
            border: 1px solid var(--success);
        }

        .alert-error {
            background: #FEF2F2;
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .saved-sets-list {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .saved-set-item {
            background: var(--white);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-sm);
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .saved-set-item:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow);
        }

        .saved-set-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .saved-set-round {
            font-weight: 700;
            color: var(--primary);
        }

        .saved-set-date {
            color: var(--gray-400);
            font-size: 0.9rem;
        }

        /* íŠ¸ë¦¬ë·° ìŠ¤íƒ€ì¼ */
        .tree-node {
            margin: 5px 0;
            user-select: none;
        }

        .tree-node-header {
            display: flex;
            align-items: center;
            padding: 8px;
            cursor: pointer;
            border-radius: var(--radius-sm);
            transition: all 0.2s;
        }

        .tree-node-header:hover {
            background: var(--gray-100);
        }

        .tree-node-header.selected {
            background: var(--primary-light);
            border: 1px solid var(--primary);
        }

        .tree-toggle {
            width: 20px;
            font-size: 0.8rem;
            margin-right: 5px;
            transition: transform 0.2s;
        }

        .tree-toggle.expanded {
            transform: rotate(90deg);
        }

        .tree-icon {
            margin-right: 5px;
        }

        .tree-children {
            margin-left: 25px;
            display: none;
        }

        .tree-children.expanded {
            display: block;
        }

        /* ì‘ì€ ë²ˆí˜¸ ë³¼ (4ì—´ ë°°ì¹˜ìš©) */
        .lotto-ball-small {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--white);
            font-size: 0.75rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* ë²ˆí˜¸ ì¡°í•© ì»¨í…Œì´ë„ˆ (4ì—´) */
        .numbers-grid-compact {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .number-set-compact {
            background: var(--gray-100);
            border-radius: var(--radius-sm);
            padding: 8px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            transition: all 0.3s;
        }

        .number-set-compact:hover {
            background: var(--gray-200);
        }

        .number-set-compact.winner-rank-1 {
            border: 3px solid #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .number-set-compact.winner-rank-2 {
            border: 3px solid #f093fb;
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1), rgba(245, 87, 108, 0.1));
        }

        .number-set-compact.winner-rank-3 {
            border: 3px solid #4facfe;
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.1), rgba(0, 242, 254, 0.1));
        }

        .number-set-compact.winner-rank-4 {
            border: 3px solid #43e97b;
            background: linear-gradient(135deg, rgba(67, 233, 123, 0.1), rgba(56, 249, 215, 0.1));
        }

        .number-set-compact.winner-rank-5 {
            border: 3px solid #fa709a;
            background: linear-gradient(135deg, rgba(250, 112, 154, 0.1), rgba(254, 225, 64, 0.1));
        }

        .number-set-label {
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--primary);
            text-align: center;
        }

        .balls-row-compact {
            display: flex;
            gap: 3px;
            justify-content: center;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .numbers-grid-compact {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--white);
            padding: 30px;
            border-radius: var(--radius-lg);
            max-width: 500px;
            width: 90%;
            animation: slideIn 0.3s ease;
        }

        .modal-header {
            margin-bottom: 20px;
        }

        .modal-header h3 {
            color: var(--dark);
            font-size: 1.5rem;
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        @media print {
            body {
                background: white;
            }
            .card {
                box-shadow: none;
                border: 1px solid var(--gray-200);
            }
            .btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="main-header">
            <h1>ğŸ¯ ë¡œë˜ ë²ˆí˜¸ ìƒì„±ê¸° Pro</h1>
            <p>ìŠ¤ë§ˆíŠ¸í•œ ë²ˆí˜¸ ìƒì„±, ì €ì¥, ë‹¹ì²¨ ì²´í¬ê¹Œì§€ í•œë²ˆì—!</p>
        </header>

        <div class="content-wrapper">
            <!-- ë©”ì¸ íŒ¨ë„ -->
            <div class="card">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('generate')">âš¡ ë²ˆí˜¸ ìƒì„±</button>
                    <button class="tab" onclick="switchTab('check')">ğŸ† ë‹¹ì²¨ ì²´í¬</button>
                    <button class="tab" onclick="switchTab('settings')">âš™ï¸ ì„¤ì •</button>
                </div>

                <!-- ë²ˆí˜¸ ìƒì„± íƒ­ -->
                <div id="generate-tab" class="tab-content active">
                    <div class="card-title">
                        <div class="icon">âš¡</div>
                        <span>ë¡œë˜ ë²ˆí˜¸ ìƒì„±</span>
                    </div>

                    <div class="control-group">
                        <label for="count-select">ìƒì„±í•  ì¡°í•© ìˆ˜</label>
                        <div class="input-group">
                            <select id="count-select">
                                <option value="5">5ê°œ ì¡°í•©</option>
                                <option value="10">10ê°œ ì¡°í•©</option>
                                <option value="20">20ê°œ ì¡°í•©</option>
                                <option value="30">30ê°œ ì¡°í•©</option>
                                <option value="50">50ê°œ ì¡°í•©</option>
                                <option value="100">100ê°œ ì¡°í•©</option>
                            </select>
                        </div>
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="generateNumbers()">
                            <span>ğŸ²</span> ë²ˆí˜¸ ìƒì„±
                        </button>
                        <button class="btn btn-secondary" onclick="saveToGitHub()" id="save-btn" disabled>
                            <span>ğŸ’¾</span> GitHub ì €ì¥
                        </button>
                        <button class="btn btn-outline" onclick="exportPDF()" id="pdf-btn" disabled>
                            <span>ğŸ“„</span> PDF ë‹¤ìš´ë¡œë“œ
                        </button>
                    </div>

                    <div id="loading-msg" class="loading" style="display: none;">
                        <div class="spinner"></div>
                        <p>ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤...</p>
                    </div>

                    <div id="generated-numbers" class="lotto-display"></div>
                </div>

                <!-- ì €ì¥ ê´€ë¦¬ íƒ­ ì œê±° -->

                <!-- ë‹¹ì²¨ ì²´í¬ íƒ­ -->
                <div id="check-tab" class="tab-content">
                    <div class="card-title">
                        <div class="icon">ğŸ†</div>
                        <span>ë‹¹ì²¨ ë²ˆí˜¸ í™•ì¸</span>
                    </div>

                    <div class="alert alert-info" style="margin-bottom: 15px;">
                        <span>ğŸ’¡</span>
                        <div>
                            <strong>ì‚¬ìš© ë°©ë²•</strong><br>
                            <small>
                                1. ì €ì¥ëœ ë²ˆí˜¸ ë¶ˆëŸ¬ì˜¤ê¸°ë¡œ ë²ˆí˜¸ ì„ íƒ<br>
                                2. íšŒì°¨ ë²ˆí˜¸ ì…ë ¥ í›„ ë‹¹ì²¨ í™•ì¸<br>
                                3. ë‹¹ì²¨ëœ ì¡°í•©ì´ í•˜ì´ë¼ì´íŠ¸ë©ë‹ˆë‹¤
                            </small>
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="loadSavedSets()" style="width: 100%; margin-bottom: 20px;">
                        <span>ğŸ”„</span> ì €ì¥ëœ ë²ˆí˜¸ ë¶ˆëŸ¬ì˜¤ê¸°
                    </button>

                    <!-- ì €ì¥ëœ ë²ˆí˜¸ íŠ¸ë¦¬ë·° -->
                    <div id="saved-tree" style="margin-bottom: 20px; max-height: 300px; overflow-y: auto; border: 1px solid var(--gray-200); border-radius: var(--radius); padding: 10px;"></div>

                    <!-- ì„ íƒëœ ë²ˆí˜¸ ì¡°í•© í‘œì‹œ ì˜ì—­ -->
                    <div id="selected-numbers" style="margin-bottom: 20px;"></div>

                    <div class="control-group">
                        <label for="check-round">í™•ì¸í•  íšŒì°¨ ë²ˆí˜¸</label>
                        <input type="number" id="check-round" placeholder="ì˜ˆ: 1196" min="1">
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="checkWinning()">
                            <span>ğŸ”</span> ë‹¹ì²¨ í™•ì¸
                        </button>
                        <button class="btn btn-secondary" onclick="getLatestRound()">
                            <span>ğŸ“Š</span> ìµœì‹  íšŒì°¨ ì¡°íšŒ
                        </button>
                    </div>

                    <div id="winning-numbers" style="margin-top: 20px;"></div>
                    <div id="check-results"></div>
                </div>

                <!-- ì„¤ì • íƒ­ -->
                <div id="settings-tab" class="tab-content">
                    <div class="card-title">
                        <div class="icon">âš™ï¸</div>
                        <span>ì„¤ì •</span>
                    </div>

                    <div class="control-group">
                        <label>GitHub ì„¤ì •</label>
                        <div class="alert alert-info" style="margin-bottom: 15px;">
                            <span>ğŸ’¡</span>
                            <div>
                                <strong>Fine-grained Token ì‚¬ìš© ê¶Œì¥</strong><br>
                                <small>Settings â†’ Developer settings â†’ Personal access tokens â†’ Fine-grained tokens<br>
                                ê¶Œí•œ: Repository (Lotto) â†’ Contents (Read and write)</small>
                            </div>
                        </div>
                        <input type="text" id="github-token" placeholder="GitHub Personal Access Token (github_pat_...)" style="margin-bottom: 10px;">
                        <div class="input-group">
                            <input type="text" id="github-owner" placeholder="ì‚¬ìš©ìëª… (ì˜ˆ: nagashino2014)" value="nagashino2014">
                            <input type="text" id="github-repo" placeholder="ì €ì¥ì†Œëª… (ì˜ˆ: Lotto)" value="Lotto">
                        </div>
                        <small style="color: var(--gray-400); margin-top: 5px; display: block;">
                            ğŸ’¡ í† í°ì€ ë¸Œë¼ìš°ì €ì— ì•ˆì „í•˜ê²Œ ì €ì¥ë©ë‹ˆë‹¤
                        </small>
                    </div>
                </div>
            </div>

            <!-- ì‚¬ì´ë“œ íŒ¨ë„ -->
            <div>
                <!-- í†µê³„ ì¹´ë“œ -->
                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-title">
                        <div class="icon">ğŸ“Š</div>
                        <span>ì˜¤ëŠ˜ì˜ í†µê³„</span>
                    </div>
                    <div id="statistics">
                        <p style="color: var(--gray-600); margin-bottom: 10px;">ìƒì„±ëœ ì¡°í•©: <strong id="total-generated">0</strong>ê°œ</p>
                        <p style="color: var(--gray-600); margin-bottom: 10px;">ì €ì¥ëœ íšŒì°¨: <strong id="total-saved">0</strong>íšŒ</p>
                        <p style="color: var(--gray-600);">ë‹¹ì²¨ í™•ì¸: <strong id="total-checked">0</strong>íšŒ</p>
                    </div>
                </div>

                <!-- ë²ˆí˜¸ ìƒ‰ìƒ ë²”ë¡€ -->
                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-title">
                        <div class="icon">ğŸ¨</div>
                        <span>ë²ˆí˜¸ êµ¬ê°„ ìƒ‰ìƒ</span>
                    </div>
                    <div style="font-size: 0.9rem;">
                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                            <div class="lotto-ball ball-yellow" style="width: 32px; height: 32px; font-size: 0.85rem; margin-right: 10px;">10</div>
                            <span style="color: var(--gray-600);">1 ~ 10</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                            <div class="lotto-ball ball-blue" style="width: 32px; height: 32px; font-size: 0.85rem; margin-right: 10px;">20</div>
                            <span style="color: var(--gray-600);">11 ~ 20</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                            <div class="lotto-ball ball-red" style="width: 32px; height: 32px; font-size: 0.85rem; margin-right: 10px;">30</div>
                            <span style="color: var(--gray-600);">21 ~ 30</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                            <div class="lotto-ball ball-gray" style="width: 32px; height: 32px; font-size: 0.85rem; margin-right: 10px;">40</div>
                            <span style="color: var(--gray-600);">31 ~ 40</span>
                        </div>
                        <div style="display: flex; align-items: center;">
                            <div class="lotto-ball ball-green" style="width: 32px; height: 32px; font-size: 0.85rem; margin-right: 10px;">45</div>
                            <span style="color: var(--gray-600);">41 ~ 45</span>
                        </div>
                    </div>
                </div>

                <!-- ë‹¹ì²¨ ì¡°ê±´ ì•ˆë‚´ -->
                <div class="card">
                    <div class="card-title">
                        <div class="icon">â„¹ï¸</div>
                        <span>ë‹¹ì²¨ ì¡°ê±´</span>
                    </div>
                    <div style="font-size: 0.9rem; color: var(--gray-600);">
                        <div style="margin-bottom: 8px;">
                            <span class="result-rank rank-1">1ë“±</span> 6ê°œ ë²ˆí˜¸ ì¼ì¹˜
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span class="result-rank rank-2">2ë“±</span> 5ê°œ + ë³´ë„ˆìŠ¤
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span class="result-rank rank-3">3ë“±</span> 5ê°œ ë²ˆí˜¸ ì¼ì¹˜
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span class="result-rank rank-4">4ë“±</span> 4ê°œ ë²ˆí˜¸ ì¼ì¹˜
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span class="result-rank rank-5">5ë“±</span> 3ê°œ ë²ˆí˜¸ ì¼ì¹˜
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ëª¨ë‹¬ -->
    <div id="saveModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ë²ˆí˜¸ ì €ì¥í•˜ê¸°</h3>
            </div>
            <div class="modal-body">
                <div class="control-group">
                    <label for="save-memo">ë©”ëª¨</label>
                    <input type="text" id="save-memo" placeholder="ì˜ˆ: ìƒì¼ ì¡°í•©, í–‰ìš´ì˜ ë²ˆí˜¸ ë“±">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="confirmSave()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <script>
        // jsPDF ì„¤ì •
        const { jsPDF } = window.jspdf;
        
        // ì „ì—­ ë³€ìˆ˜
        let currentNumbers = [];
        let savedSets = [];
        let selectedSavedData = null; // ì„ íƒëœ ì €ì¥ ë°ì´í„°
        let statistics = {
            generated: 0,
            saved: 0,
            checked: 0
        };

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            // ëª¨ë“  íƒ­ê³¼ ì»¨í…ì¸  ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            event.target.classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }

        // ë²ˆí˜¸ ìƒì„± í•¨ìˆ˜
        function generateNumbers() {
            const count = parseInt(document.getElementById('count-select').value);
            currentNumbers = [];
            
            for (let i = 0; i < count; i++) {
                const numbers = new Set();
                while (numbers.size < 6) {
                    numbers.add(Math.floor(Math.random() * 45) + 1);
                }
                currentNumbers.push(Array.from(numbers).sort((a, b) => a - b));
            }
            
            displayNumbers(currentNumbers);
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            statistics.generated += count;
            updateStatistics();
            
            // ë²„íŠ¼ í™œì„±í™”
            document.getElementById('save-btn').disabled = false;
            document.getElementById('pdf-btn').disabled = false;
        }

        // ë²ˆí˜¸ í‘œì‹œ í•¨ìˆ˜ (5ê°œì”© ì¹´ë“œë¡œ ë¬¶ì–´ì„œ 2ì—´ ë°°ì¹˜)
        function displayNumbers(numbers) {
            const container = document.getElementById('generated-numbers');
            container.innerHTML = '';
            
            // 5ê°œì”© ë¬¶ì–´ì„œ ì¹´ë“œë¡œ í‘œì‹œ
            for (let cardIndex = 0; cardIndex < numbers.length; cardIndex += 5) {
                const cardNumbers = numbers.slice(cardIndex, cardIndex + 5);
                const cardDiv = document.createElement('div');
                cardDiv.className = 'lotto-card';
                
                // ì¹´ë“œ íƒ€ì´í‹€
                const titleDiv = document.createElement('div');
                titleDiv.className = 'lotto-card-title';
                const startNum = cardIndex + 1;
                const endNum = Math.min(cardIndex + 5, numbers.length);
                titleDiv.innerHTML = `<span>ğŸ²</span> ì¡°í•© ${startNum} - ${endNum}`;
                cardDiv.appendChild(titleDiv);
                
                // ì¹´ë“œ ë‚´ ë²ˆí˜¸ ì„¸íŠ¸ë“¤
                cardNumbers.forEach((set, index) => {
                    const setDiv = document.createElement('div');
                    setDiv.className = 'lotto-set';
                    
                    const numberDiv = document.createElement('div');
                    numberDiv.className = 'lotto-set-number';
                    numberDiv.textContent = `${(cardIndex + index + 1).toString().padStart(2, '0')}.`;
                    
                    const ballsDiv = document.createElement('div');
                    ballsDiv.className = 'lotto-balls';
                    
                    set.forEach(num => {
                        const ball = document.createElement('div');
                        
                        // ë²ˆí˜¸ êµ¬ê°„ë³„ ìƒ‰ìƒ í´ë˜ìŠ¤ ì ìš©
                        let colorClass = '';
                        if (num >= 1 && num <= 10) {
                            colorClass = 'ball-yellow';
                        } else if (num >= 11 && num <= 20) {
                            colorClass = 'ball-blue';
                        } else if (num >= 21 && num <= 30) {
                            colorClass = 'ball-red';
                        } else if (num >= 31 && num <= 40) {
                            colorClass = 'ball-gray';
                        } else if (num >= 41 && num <= 45) {
                            colorClass = 'ball-green';
                        }
                        
                        ball.className = `lotto-ball ${colorClass}`;
                        ball.textContent = num;
                        ballsDiv.appendChild(ball);
                    });
                    
                    setDiv.appendChild(numberDiv);
                    setDiv.appendChild(ballsDiv);
                    cardDiv.appendChild(setDiv);
                });
                
                container.appendChild(cardDiv);
            }
        }

        // GitHub ì €ì¥ í•¨ìˆ˜
        function saveToGitHub() {
            const modal = document.getElementById('saveModal');
            modal.classList.add('active');
        }

        function closeModal() {
            const modal = document.getElementById('saveModal');
            modal.classList.remove('active');
        }

        async function confirmSave() {
            const memo = document.getElementById('save-memo').value;
            const token = document.getElementById('github-token').value;
            const owner = document.getElementById('github-owner').value || 'nagashino2014';
            const repo = document.getElementById('github-repo').value || 'Lotto';
            
            if (!memo) {
                alert('ë©”ëª¨ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!token) {
                alert('GitHub Personal Access Tokenì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\n\nğŸ“ Fine-grained Token ìƒì„± ë°©ë²•:\n1. GitHub â†’ Settings â†’ Developer settings\n2. Personal access tokens â†’ Fine-grained tokens\n3. Repository: Lotto ì„ íƒ\n4. Contents: Read and write ê¶Œí•œ ë¶€ì—¬');
                return;
            }
            
            const now = new Date();
            const data = {
                memo: memo,
                savedAt: now.toISOString(),
                savedDate: now.toLocaleDateString('ko-KR'),
                savedTime: now.toLocaleTimeString('ko-KR'),
                numbers: currentNumbers
            };
            
            const timestamp = Date.now();
            const filename = `lotto_${timestamp}.json`;
            const content = btoa(unescape(encodeURIComponent(JSON.stringify(data, null, 2))));
            
            try {
                const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${filename}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json',
                        'Accept': 'application/vnd.github+json',
                        'X-GitHub-Api-Version': '2022-11-28'
                    },
                    body: JSON.stringify({
                        message: `Add lotto numbers: ${memo}`,
                        content: content
                    })
                });
                
                if (response.ok) {
                    alert(`ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\në©”ëª¨: ${memo}`);
                    statistics.saved++;
                    updateStatistics();
                    closeModal();
                } else {
                    const error = await response.json();
                    let errorMsg = `ì €ì¥ ì‹¤íŒ¨: ${error.message}`;
                    
                    if (response.status === 404) {
                        errorMsg += '\n\nâŒ ì €ì¥ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nâœ… GitHubì—ì„œ "Lotto" ì €ì¥ì†Œë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.';
                    } else if (response.status === 403) {
                        errorMsg += '\n\nâŒ ê¶Œí•œì´ ë¶€ì¡±í•©ë‹ˆë‹¤.\nâœ… Token ê¶Œí•œ í™•ì¸:\n- Contents: Read and write\n- Repository: Lotto ì„ íƒë¨';
                    } else if (response.status === 401) {
                        errorMsg += '\n\nâŒ ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\nâœ… í† í°ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.\nâœ… Fine-grained tokenì˜ ê²½ìš° ë§Œë£Œë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.';
                    }
                    
                    alert(errorMsg);
                }
            } catch (error) {
                alert(`ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`);
            }
        }

        // ì €ì¥ëœ ë²ˆí˜¸ ë¶ˆëŸ¬ì˜¤ê¸° (íŠ¸ë¦¬ë·° êµ¬ì¡°)
        async function loadSavedSets() {
            const token = document.getElementById('github-token').value;
            const owner = document.getElementById('github-owner').value || 'nagashino2014';
            const repo = document.getElementById('github-repo').value || 'Lotto';
            
            if (!token) {
                alert('GitHub Personal Access Tokenì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\n\nì„¤ì • íƒ­ì—ì„œ í† í°ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }
            
            try {
                const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Accept': 'application/vnd.github+json',
                        'X-GitHub-Api-Version': '2022-11-28'
                    }
                });
                
                if (response.ok) {
                    const files = await response.json();
                    const lottoFiles = files.filter(file => file.name.startsWith('lotto_') && file.name.endsWith('.json'));
                    
                    // ëª¨ë“  íŒŒì¼ ë°ì´í„° ë¡œë“œ
                    const allData = [];
                    for (const file of lottoFiles) {
                        try {
                            const contentResponse = await fetch(file.download_url);
                            const data = await contentResponse.json();
                            data._filename = file.name; // íŒŒì¼ëª… ì €ì¥
                            allData.push(data);
                        } catch (e) {
                            console.error(`íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨: ${file.name}`, e);
                        }
                    }
                    
                    // íŠ¸ë¦¬ êµ¬ì¡° ìƒì„±
                    buildTreeView(allData);
                    
                } else {
                    const error = await response.json();
                    let errorMsg = 'ì €ì¥ëœ ë²ˆí˜¸ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    
                    if (response.status === 404) {
                        errorMsg = 'âŒ ì €ì¥ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\nâœ… GitHubì—ì„œ "Lotto" ì €ì¥ì†Œë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.\nâœ… ì €ì¥ì†Œ ì´ë¦„ê³¼ ì‚¬ìš©ìëª…ì´ ì •í™•í•œì§€ í™•ì¸í•˜ì„¸ìš”.';
                    } else if (response.status === 403) {
                        errorMsg = 'âŒ ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.\n\nâœ… Token ê¶Œí•œì„ í™•ì¸í•˜ì„¸ìš”:\n- Repository: Lotto ì„ íƒë¨\n- Contents: Read and write\n- Metadata: Read-only';
                    }
                    
                    alert(errorMsg);
                }
            } catch (error) {
                alert(`ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`);
            }
        }
        
        // íŠ¸ë¦¬ êµ¬ì¡° ìƒì„±
        function buildTreeView(data) {
            const container = document.getElementById('saved-tree');
            container.innerHTML = '';
            
            if (data.length === 0) {
                container.innerHTML = '<p style="color: var(--gray-400); text-align: center; padding: 20px;">ì €ì¥ëœ ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            // ë‚ ì§œë³„ë¡œ ê·¸ë£¹í™”: ì—°ë„ > ì›” > ë‚ ì§œ
            const tree = {};
            data.forEach(item => {
                const date = new Date(item.savedAt);
                const year = date.getFullYear();
                const month = date.getMonth() + 1;
                const day = date.getDate();
                
                if (!tree[year]) tree[year] = {};
                if (!tree[year][month]) tree[year][month] = {};
                if (!tree[year][month][day]) tree[year][month][day] = [];
                
                tree[year][month][day].push(item);
            });
            
            // íŠ¸ë¦¬ ë Œë”ë§
            Object.keys(tree).sort((a, b) => b - a).forEach(year => {
                const yearNode = createTreeNode(`ğŸ“… ${year}ë…„`, null, true);
                container.appendChild(yearNode);
                
                const yearChildren = document.createElement('div');
                yearChildren.className = 'tree-children';
                yearNode.appendChild(yearChildren);
                
                Object.keys(tree[year]).sort((a, b) => b - a).forEach(month => {
                    const monthNode = createTreeNode(`ğŸ“† ${month}ì›”`, null, true);
                    yearChildren.appendChild(monthNode);
                    
                    const monthChildren = document.createElement('div');
                    monthChildren.className = 'tree-children';
                    monthNode.appendChild(monthChildren);
                    
                    Object.keys(tree[year][month]).sort((a, b) => b - a).forEach(day => {
                        const dayNode = createTreeNode(`ğŸ“ ${day}ì¼`, null, true);
                        monthChildren.appendChild(dayNode);
                        
                        const dayChildren = document.createElement('div');
                        dayChildren.className = 'tree-children';
                        dayNode.appendChild(dayChildren);
                        
                        tree[year][month][day].forEach(item => {
                            const memoText = item.memo || 'ì œëª© ì—†ìŒ';
                            const timeText = item.savedTime || new Date(item.savedAt).toLocaleTimeString('ko-KR');
                            const leafNode = createTreeNode(`ğŸ² ${memoText}`, `â° ${timeText}`, false, item);
                            dayChildren.appendChild(leafNode);
                        });
                    });
                });
            });
        }
        
        // íŠ¸ë¦¬ ë…¸ë“œ ìƒì„±
        function createTreeNode(label, sublabel, hasChildren, data = null) {
            const nodeDiv = document.createElement('div');
            nodeDiv.className = 'tree-node';
            
            const headerDiv = document.createElement('div');
            headerDiv.className = 'tree-node-header';
            
            if (hasChildren) {
                const toggle = document.createElement('span');
                toggle.className = 'tree-toggle';
                toggle.textContent = 'â–¶';
                headerDiv.appendChild(toggle);
                
                headerDiv.onclick = () => {
                    toggle.classList.toggle('expanded');
                    const children = nodeDiv.querySelector('.tree-children');
                    if (children) {
                        children.classList.toggle('expanded');
                    }
                };
            } else {
                // ìµœí•˜ë‹¨ ë…¸ë“œ (ë²ˆí˜¸ ë°ì´í„°)
                headerDiv.style.paddingLeft = '25px';
                headerDiv.onclick = () => {
                    // ê¸°ì¡´ ì„ íƒ í•´ì œ
                    document.querySelectorAll('.tree-node-header.selected').forEach(el => {
                        el.classList.remove('selected');
                    });
                    headerDiv.classList.add('selected');
                    
                    // ë²ˆí˜¸ í‘œì‹œ
                    displaySavedNumbers(data);
                };
            }
            
            const labelSpan = document.createElement('span');
            labelSpan.textContent = label;
            labelSpan.style.flex = '1';
            headerDiv.appendChild(labelSpan);
            
            if (sublabel) {
                const sublabelSpan = document.createElement('span');
                sublabelSpan.textContent = sublabel;
                sublabelSpan.style.fontSize = '0.8rem';
                sublabelSpan.style.color = 'var(--gray-400)';
                headerDiv.appendChild(sublabelSpan);
            }
            
            nodeDiv.appendChild(headerDiv);
            return nodeDiv;
        }
        
        // ì €ì¥ëœ ë²ˆí˜¸ í‘œì‹œ (4ì—´ ì»´íŒ©íŠ¸)
        function displaySavedNumbers(data) {
            selectedSavedData = data;
            currentNumbers = data.numbers;
            
            const container = document.getElementById('selected-numbers');
            container.innerHTML = `
                <div class="alert alert-info" style="margin-bottom: 10px;">
                    <span>âœ…</span>
                    <div>
                        <strong>${data.memo}</strong><br>
                        <small>ì €ì¥ ì‹œê°: ${data.savedDate} ${data.savedTime}</small><br>
                        <small>ì´ ${data.numbers.length}ê°œ ì¡°í•©</small>
                    </div>
                </div>
            `;
            
            const gridDiv = document.createElement('div');
            gridDiv.className = 'numbers-grid-compact';
            gridDiv.id = 'numbers-compact-display';
            
            data.numbers.forEach((numbers, index) => {
                const setDiv = document.createElement('div');
                setDiv.className = 'number-set-compact';
                setDiv.dataset.index = index;
                
                const label = document.createElement('div');
                label.className = 'number-set-label';
                label.textContent = `#${index + 1}`;
                setDiv.appendChild(label);
                
                const ballsRow = document.createElement('div');
                ballsRow.className = 'balls-row-compact';
                
                numbers.forEach(num => {
                    const ball = document.createElement('div');
                    ball.className = `lotto-ball-small ${getBallColorClass(num)}`;
                    ball.textContent = num;
                    ballsRow.appendChild(ball);
                });
                
                setDiv.appendChild(ballsRow);
                gridDiv.appendChild(setDiv);
            });
            
            container.appendChild(gridDiv);
        }
        
        // ë²ˆí˜¸ ìƒ‰ìƒ í´ë˜ìŠ¤ ê°€ì ¸ì˜¤ê¸°
        function getBallColorClass(num) {
            if (num >= 1 && num <= 10) return 'ball-yellow';
            if (num >= 11 && num <= 20) return 'ball-blue';
            if (num >= 21 && num <= 30) return 'ball-red';
            if (num >= 31 && num <= 40) return 'ball-gray';
            if (num >= 41 && num <= 45) return 'ball-green';
            return '';
        }

        // ë‹¹ì²¨ í™•ì¸ í•¨ìˆ˜ (ê°œì„ )
        async function checkWinning() {
            const round = document.getElementById('check-round').value;
            
            if (!round) {
                alert('í™•ì¸í•  íšŒì°¨ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (currentNumbers.length === 0) {
                alert('ë¨¼ì € ì €ì¥ëœ ë²ˆí˜¸ë¥¼ ë¶ˆëŸ¬ì™€ì£¼ì„¸ìš”.\n\n"ì €ì¥ëœ ë²ˆí˜¸ ë¶ˆëŸ¬ì˜¤ê¸°" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.');
                return;
            }
            
            // ë¡œë”© í‘œì‹œ
            const winningContainer = document.getElementById('winning-numbers');
            winningContainer.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>ë‹¹ì²¨ ë²ˆí˜¸ë¥¼ ì¡°íšŒí•˜ëŠ” ì¤‘...</p>
                </div>
            `;
            
            try {
                const winningData = await fetchWinningNumbers(round);
                
                if (winningData === null) {
                    // ë¯¸ì¶”ì²¨ íšŒì°¨
                    winningContainer.innerHTML = `
                        <div class="alert alert-error">
                            <span>âš ï¸</span>
                            <div>
                                <strong>${round}íšŒì°¨ëŠ” ì•„ì§ ì¶”ì²¨ì´ ì´ë£¨ì–´ì§€ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</strong><br>
                                <small>ì¶”ì²¨ í›„ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.</small>
                            </div>
                        </div>
                    `;
                    document.getElementById('check-results').innerHTML = '';
                    return;
                }
                
                // ë‹¹ì²¨ ë²ˆí˜¸ í‘œì‹œ
                displayWinningNumbers(winningData);
                // ë‹¹ì²¨ ê²°ê³¼ í™•ì¸ ë° í•˜ì´ë¼ì´íŠ¸
                checkResultsWithHighlight(winningData);
                statistics.checked++;
                updateStatistics();
                
            } catch (error) {
                winningContainer.innerHTML = `
                    <div class="alert alert-error">
                        <span>âŒ</span>
                        <div>
                            <strong>ë‹¹ì²¨ ë²ˆí˜¸ë¥¼ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</strong><br>
                            <small>${error.message}</small>
                        </div>
                    </div>
                `;
            }
        }
        
        // ë‹¹ì²¨ ê²°ê³¼ í™•ì¸ ë° í•˜ì´ë¼ì´íŠ¸
        function checkResultsWithHighlight(winningData) {
            const results = [];
            const winningNumbers = winningData.numbers;
            const bonusNumber = winningData.bonus;
            
            currentNumbers.forEach((myNumbers, index) => {
                const matchCount = myNumbers.filter(num => winningNumbers.includes(num)).length;
                const bonusMatch = myNumbers.includes(bonusNumber);
                
                let rank = 0;
                if (matchCount === 6) {
                    rank = 1;
                } else if (matchCount === 5 && bonusMatch) {
                    rank = 2;
                } else if (matchCount === 5) {
                    rank = 3;
                } else if (matchCount === 4) {
                    rank = 4;
                } else if (matchCount === 3) {
                    rank = 5;
                }
                
                if (rank > 0) {
                    results.push({
                        index: index,
                        numbers: myNumbers,
                        rank: rank,
                        matchCount: matchCount,
                        bonusMatch: bonusMatch
                    });
                }
            });
            
            // í•˜ì´ë¼ì´íŠ¸ í‘œì‹œ
            applyWinnerHighlights(results);
            
            // ê²°ê³¼ í‘œì‹œ
            displayCheckResultsEnhanced(results, winningData);
        }
        
        // ë‹¹ì²¨ ì¡°í•©ì— í•˜ì´ë¼ì´íŠ¸ ì ìš©
        function applyWinnerHighlights(results) {
            // ê¸°ì¡´ í•˜ì´ë¼ì´íŠ¸ ì œê±°
            document.querySelectorAll('.number-set-compact').forEach(el => {
                el.classList.remove('winner-rank-1', 'winner-rank-2', 'winner-rank-3', 'winner-rank-4', 'winner-rank-5');
            });
            
            // ë‹¹ì²¨ ì¡°í•©ì— í•˜ì´ë¼ì´íŠ¸ ì¶”ê°€
            results.forEach(result => {
                const setEl = document.querySelector(`.number-set-compact[data-index="${result.index}"]`);
                if (setEl) {
                    setEl.classList.add(`winner-rank-${result.rank}`);
                }
            });
        }
        
        // ë‹¹ì²¨ ê²°ê³¼ í‘œì‹œ (ê°œì„ )
        function displayCheckResultsEnhanced(results, winningData) {
            const container = document.getElementById('check-results');
            
            if (results.length === 0) {
                container.innerHTML = `
                    <div class="alert alert-error" style="margin-top: 20px;">
                        <span>ğŸ˜”</span>
                        <div>ì•„ì‰½ê²Œë„ ë‹¹ì²¨ëœ ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ìŒ ê¸°íšŒì—!</div>
                    </div>
                `;
                return;
            }
            
            // ë“±ìœ„ë³„ ê·¸ë£¹í™”
            const rankGroups = {};
            results.forEach(r => {
                if (!rankGroups[r.rank]) rankGroups[r.rank] = [];
                rankGroups[r.rank].push(r);
            });
            
            // ì´ ë‹¹ì²¨ê¸ˆ ê³„ì‚° (4,5ë“± ê³ ì •ê¸ˆì•¡ í¬í•¨)
            let totalPrize = 0;
            Object.keys(rankGroups).forEach(rank => {
                const count = rankGroups[rank].length;
                let amount = winningData.prize[rank]?.amount || 0;
                
                // 4,5ë“± ê³ ì • ê¸ˆì•¡ ì ìš©
                if (rank == 4) amount = amount || 50000;
                if (rank == 5) amount = amount || 5000;
                
                totalPrize += count * amount;
            });
            
            const rankNames = ['', '1ë“±', '2ë“±', '3ë“±', '4ë“±', '5ë“±'];
            const rankColors = ['', '#667eea', '#f093fb', '#4facfe', '#43e97b', '#fa709a'];
            
            container.innerHTML = `
                <div class="check-result" style="margin-top: 20px;">
                    <h4>ğŸŠ ì¶•í•˜í•©ë‹ˆë‹¤! ${results.length}ê°œ ì¡°í•© ë‹¹ì²¨!</h4>
                    <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: var(--radius); color: white; text-align: center;">
                        <div style="font-size: 0.9rem; margin-bottom: 5px;">ì˜ˆìƒ ë‹¹ì²¨ê¸ˆ</div>
                        <div style="font-size: 1.8rem; font-weight: 700;">${totalPrize.toLocaleString()}ì›</div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <strong>ë“±ìœ„ë³„ ë‹¹ì²¨ ë‚´ì—­:</strong>
                    </div>
                    
                    ${Object.keys(rankGroups).sort((a, b) => a - b).map(rank => {
                        const group = rankGroups[rank];
                        let amount = winningData.prize[rank]?.amount || 0;
                        
                        // 4,5ë“± ê³ ì • ê¸ˆì•¡ ì ìš©
                        if (rank == 4) amount = amount || 50000;
                        if (rank == 5) amount = amount || 5000;
                        
                        const indices = group.map(r => `#${r.index + 1}`).join(', ');
                        
                        return `
                            <div style="background: white; border-radius: var(--radius-sm); padding: 15px; margin-bottom: 10px; border-left: 4px solid ${rankColors[rank]};">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <div>
                                        <span style="background: ${rankColors[rank]}; color: white; padding: 4px 12px; border-radius: 20px; font-weight: 700; font-size: 0.9rem;">${rankNames[rank]}</span>
                                        <span style="margin-left: 10px; font-weight: 600; color: var(--dark);">${group.length}ê°œ ì¡°í•©</span>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-size: 1.1rem; font-weight: 700; color: var(--primary);">${(amount * group.length).toLocaleString()}ì›</div>
                                        <div style="font-size: 0.8rem; color: var(--gray-400);">ê°œë‹¹ ${amount.toLocaleString()}ì›</div>
                                    </div>
                                </div>
                                <div style="font-size: 0.85rem; color: var(--gray-600);">
                                    <strong>ë‹¹ì²¨ ì¡°í•©:</strong> ${indices}
                                </div>
                            </div>
                        `;
                    }).join('')}
                    
                    <div style="margin-top: 15px; padding: 10px; background: var(--gray-100); border-radius: var(--radius-sm); font-size: 0.85rem; color: var(--gray-600);">
                        ğŸ’¡ í™”ë©´ì— í‘œì‹œëœ ë²ˆí˜¸ ì¡°í•©ì— ìƒ‰ìƒ í…Œë‘ë¦¬ë¡œ ë‹¹ì²¨ ë“±ìœ„ê°€ í‘œì‹œë©ë‹ˆë‹¤.<br>
                        <small style="color: var(--gray-500); margin-top: 5px; display: block;">
                        ${totalPrize === 0 ? 'âš ï¸ ë‹¹ì²¨ê¸ˆ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì‹¤ì œ ë‹¹ì²¨ê¸ˆì€ ë™í–‰ë³µê¶Œ ì‚¬ì´íŠ¸ì—ì„œ í™•ì¸í•˜ì„¸ìš”.' : ''}
                        </small>
                    </div>
                </div>
            `;
        }

        // ë‹¹ì²¨ ë²ˆí˜¸ ìºì‹œ (ë©”ëª¨ë¦¬)
        const winningNumbersCache = {};
        
        // CSV ë°ì´í„° ìºì‹œ
        let lottoDataCache = null;
        
        // CSV íŒŒì¼ì—ì„œ ë¡œë˜ ë°ì´í„° ë¡œë“œ
        async function loadLottoDataFromCSV() {
            if (lottoDataCache) {
                return lottoDataCache;
            }
            
            try {
                console.log('ğŸ“‚ ë¡œë˜ ë°ì´í„° CSV ë¡œë“œ ì¤‘...');
                const response = await fetch('lotto_data.csv');
                if (!response.ok) {
                    throw new Error('CSV íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                const data = {};
                
                // í—¤ë” ì œì™¸í•˜ê³  íŒŒì‹±
                for (let i = 1; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (!line) continue;
                    
                    const cols = line.split(',');
                    if (cols.length < 12) continue;
                    
                    const round = parseInt(cols[0]);
                    data[round] = {
                        round: round,
                        date: cols[1],
                        numbers: [
                            parseInt(cols[2]),
                            parseInt(cols[3]),
                            parseInt(cols[4]),
                            parseInt(cols[5]),
                            parseInt(cols[6]),
                            parseInt(cols[7])
                        ],
                        bonus: parseInt(cols[8]),
                        prize: {
                            1: { count: 0, amount: parseInt(cols[9]) || 0 },
                            2: { count: 0, amount: parseInt(cols[10]) || 0 },
                            3: { count: 0, amount: parseInt(cols[11]) || 0 },
                            4: { count: 0, amount: 50000 },
                            5: { count: 0, amount: 5000 }
                        }
                    };
                }
                
                lottoDataCache = data;
                console.log('âœ… CSV ë¡œë“œ ì™„ë£Œ:', Object.keys(data).length, 'ê°œ íšŒì°¨');
                return data;
                
            } catch (error) {
                console.error('âŒ CSV ë¡œë“œ ì‹¤íŒ¨:', error);
                return null;
            }
        }
        
        // ë‹¹ì²¨ ë²ˆí˜¸ ì¡°íšŒ (CSV ìš°ì„ , ë¹ ë¥´ê³  ì •í™•!)
        async function fetchWinningNumbers(round) {
            // ìºì‹œ í™•ì¸
            if (winningNumbersCache[round]) {
                console.log('âœ… ë©”ëª¨ë¦¬ ìºì‹œì—ì„œ ë¡œë“œ');
                return winningNumbersCache[round];
            }
            
            // ë°©ë²• 1: CSV íŒŒì¼ì—ì„œ ì¡°íšŒ (ê°€ì¥ ë¹ ë¥´ê³  ì•ˆì •ì !)
            try {
                console.log('ğŸ¯ CSV íŒŒì¼ì—ì„œ ë‹¹ì²¨ë²ˆí˜¸ ì¡°íšŒ...');
                const csvData = await loadLottoDataFromCSV();
                
                if (csvData && csvData[round]) {
                    console.log('âœ… CSVì—ì„œ ì¡°íšŒ ì„±ê³µ! (ì¦‰ì‹œ ë°˜í™˜)');
                    winningNumbersCache[round] = csvData[round];
                    return csvData[round];
                } else {
                    console.log('âš ï¸ CSVì— í•´ë‹¹ íšŒì°¨ ì—†ìŒ:', round);
                }
            } catch (csvError) {
                console.log('CSV ì¡°íšŒ ì‹¤íŒ¨:', csvError.message);
            }
            
            // ë°©ë²• 2: ë™í–‰ë³µê¶Œ API ì§ì ‘ í˜¸ì¶œ (CSVì— ì—†ëŠ” ìµœì‹  íšŒì°¨ìš©)
            try {
                console.log('ë™í–‰ë³µê¶Œ API ì‹œë„...');
                const directResponse = await Promise.race([
                    fetch(`https://www.dhlottery.co.kr/common.do?method=getLottoNumber&drwNo=${round}`),
                    new Promise((_, reject) => 
                        setTimeout(() => reject(new Error('Timeout')), 3000)
                    )
                ]);
                
                if (directResponse.ok) {
                    const data = await directResponse.json();
                    
                    if (data.returnValue === 'fail') {
                        return null; // ë¯¸ì¶”ì²¨ íšŒì°¨
                    }
                    
                    console.log('âœ… ë™í–‰ë³µê¶Œ API ì„±ê³µ!');
                    const result = parseWinningData(data);
                    winningNumbersCache[round] = result;
                    return result;
                }
            } catch (directError) {
                console.log('ë™í–‰ë³µê¶Œ API ì‹¤íŒ¨:', directError.message);
            }
            
            // ë°©ë²• 3: Netlify Functions (ë°°í¬ í™˜ê²½)
            if (window.location.hostname.includes('netlify.app')) {
                try {
                    console.log('Netlify Functions ì‹œë„...');
                    const netlifyResponse = await fetch(`/.netlify/functions/lotto-scraper?round=${round}`);
                    if (netlifyResponse.ok) {
                        const data = await netlifyResponse.json();
                        if (!data.error) {
                            console.log('âœ… Netlify Functions ì„±ê³µ!');
                            winningNumbersCache[round] = data;
                            return data;
                        }
                    }
                } catch (netlifyError) {
                    console.log('Netlify Functions ì‹¤íŒ¨:', netlifyError.message);
                }
            }
            
            // ëª¨ë“  ë°©ë²• ì‹¤íŒ¨
            throw new Error(`${round}íšŒì°¨ ë‹¹ì²¨ë²ˆí˜¸ë¥¼ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\nğŸ’¡ í•´ê²° ë°©ë²•:\n1. CSV íŒŒì¼ì— í•´ë‹¹ íšŒì°¨ê°€ ì—†ìŠµë‹ˆë‹¤.\n2. ìµœì‹  íšŒì°¨ëŠ” CSV ì—…ë°ì´íŠ¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.\n3. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.`);
        }
        
        // ë„¤ì´ë²„ HTML íŒŒì‹± í•¨ìˆ˜
        function parseNaverLottoHtml(html, round) {
            const result = {
                round: parseInt(round),
                date: '',
                numbers: [],
                bonus: 0,
                prize: {
                    1: { count: 0, amount: 0 },
                    2: { count: 0, amount: 0 },
                    3: { count: 0, amount: 0 },
                    4: { count: 0, amount: 50000 },
                    5: { count: 0, amount: 5000 },
                }
            };

            try {
                // ë””ë²„ê¹…: HTML ì¼ë¶€ í™•ì¸
                console.log('HTML ê¸¸ì´:', html.length);
                
                let balls = [];
                
                // íŒ¨í„´ 1: ë„¤ì´ë²„ ë¡œë˜ ìœ„ì ¯ - <span class="ball_645 lrg ball_1">1</span>
                // ê°œì„ ëœ ì •ê·œì‹: ball_ ë’¤ì˜ ìˆ«ìë¥¼ ë” ì •í™•í•˜ê²Œ ì¶”ì¶œ
                const ballRegex1 = /<span[^>]*class="[^"]*ball_645[^"]*lrg[^"]*"[^>]*>(\d+)<\/span>/gi;
                let match;
                
                while ((match = ballRegex1.exec(html)) !== null) {
                    const num = parseInt(match[1]);
                    if (num >= 1 && num <= 45 && balls.length < 7) {
                        balls.push(num);
                    }
                }
                
                console.log('íŒ¨í„´ 1 ê²°ê³¼:', balls);
                
                // íŒ¨í„´ 2: <em class="ball num_1">1</em> í˜•ì‹ (ëª¨ë°”ì¼)
                if (balls.length < 7) {
                    balls = [];
                    const ballRegex2 = /<em[^>]*class="[^"]*ball[^"]*"[^>]*>(\d+)<\/em>/gi;
                    while ((match = ballRegex2.exec(html)) !== null) {
                        const num = parseInt(match[1]);
                        if (num >= 1 && num <= 45 && balls.length < 7) {
                            balls.push(num);
                        }
                    }
                    console.log('íŒ¨í„´ 2 ê²°ê³¼:', balls);
                }
                
                // íŒ¨í„´ 3: data-value ì†ì„±ì—ì„œ ì¶”ì¶œ
                if (balls.length < 7) {
                    balls = [];
                    const ballRegex3 = /data-value="(\d+)"/gi;
                    while ((match = ballRegex3.exec(html)) !== null) {
                        const num = parseInt(match[1]);
                        if (num >= 1 && num <= 45 && balls.length < 7) {
                            balls.push(num);
                        }
                    }
                    console.log('íŒ¨í„´ 3 ê²°ê³¼:', balls);
                }
                
                // íŒ¨í„´ 4: íŠ¹ì • ì˜ì—­ ë‚´ ìˆ«ì ì¶”ì¶œ (ìµœí›„ì˜ ìˆ˜ë‹¨)
                if (balls.length < 7) {
                    balls = [];
                    // "ë‹¹ì²¨ë²ˆí˜¸" ë˜ëŠ” "winning" í‚¤ì›Œë“œ ê·¼ì²˜ ì°¾ê¸°
                    const winningMatch = html.match(/(?:ë‹¹ì²¨ë²ˆí˜¸|winning[\s\S]{0,300})/i);
                    if (winningMatch) {
                        const section = winningMatch[0];
                        // ì—°ì†ëœ 1-45 ì‚¬ì´ì˜ ìˆ«ì ì°¾ê¸°
                        const numRegex = /\b([1-9]|[1-3][0-9]|4[0-5])\b/g;
                        while ((match = numRegex.exec(section)) !== null && balls.length < 7) {
                            const num = parseInt(match[1]);
                            if (!balls.includes(num)) { // ì¤‘ë³µ ì œê±°
                                balls.push(num);
                            }
                        }
                    }
                    console.log('íŒ¨í„´ 4 ê²°ê³¼:', balls);
                }

                if (balls.length === 7) {
                    result.numbers = balls.slice(0, 6).sort((a, b) => a - b);
                    result.bonus = balls[6];
                } else if (balls.length >= 6) {
                    result.numbers = balls.slice(0, 6).sort((a, b) => a - b);
                    console.warn('ë³´ë„ˆìŠ¤ ë²ˆí˜¸ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
                } else {
                    console.error('ì¶©ë¶„í•œ ë‹¹ì²¨ë²ˆí˜¸ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤:', balls);
                    return null;
                }

                // ì¶”ì²¨ì¼ ì¶”ì¶œ
                const dateRegex = /(\d{4})[\.\-\/](\d{1,2})[\.\-\/](\d{1,2})/;
                const dateMatch = html.match(dateRegex);
                if (dateMatch) {
                    const year = dateMatch[1];
                    const month = dateMatch[2].padStart(2, '0');
                    const day = dateMatch[3].padStart(2, '0');
                    result.date = `${year}.${month}.${day}`;
                }

                // ë‹¹ì²¨ê¸ˆ ì¶”ì¶œ (1~3ë“±) - ê°œì„ ëœ ì •ê·œì‹
                const prizeAmounts = [];
                
                // "ì´ ë‹¹ì²¨ê¸ˆ" ì œì™¸í•˜ê³  "1ë“±", "2ë“±", "3ë“±" ë‹¹ì²¨ê¸ˆë§Œ ì¶”ì¶œ
                const prizeSection = html.match(/(?:1ë“±[\s\S]{0,200}?2ë“±[\s\S]{0,200}?3ë“±[\s\S]{0,200})/);
                if (prizeSection) {
                    // ê° ë“±ìˆ˜ë³„ë¡œ ê°œë³„ ì¶”ì¶œ
                    const rank1Match = prizeSection[0].match(/1ë“±[^0-9]+([\d,]+)\s*ì›/);
                    const rank2Match = prizeSection[0].match(/2ë“±[^0-9]+([\d,]+)\s*ì›/);
                    const rank3Match = prizeSection[0].match(/3ë“±[^0-9]+([\d,]+)\s*ì›/);
                    
                    if (rank1Match) {
                        const amount = parseInt(rank1Match[1].replace(/,/g, ''));
                        if (amount > 100000) prizeAmounts.push(amount); // 10ë§Œì› ì´ìƒ
                    }
                    if (rank2Match) {
                        const amount = parseInt(rank2Match[1].replace(/,/g, ''));
                        if (amount > 10000) prizeAmounts.push(amount); // 1ë§Œì› ì´ìƒ
                    }
                    if (rank3Match) {
                        const amount = parseInt(rank3Match[1].replace(/,/g, ''));
                        if (amount > 1000) prizeAmounts.push(amount); // 1ì²œì› ì´ìƒ
                    }
                }

                if (prizeAmounts.length >= 3) {
                    result.prize[1].amount = prizeAmounts[0];
                    result.prize[2].amount = prizeAmounts[1];
                    result.prize[3].amount = prizeAmounts[2];
                }

                console.log('ìµœì¢… íŒŒì‹± ê²°ê³¼:', result);
                return result;
                
            } catch (parseError) {
                console.error('HTML íŒŒì‹± ì˜¤ë¥˜:', parseError);
                return null;
            }
        }
        
        // ë‹¹ì²¨ ë°ì´í„° íŒŒì‹± í•¨ìˆ˜
        function parseWinningData(data) {
            return {
                round: data.drwNo,
                date: data.drwNoDate,
                numbers: [
                    data.drwtNo1, data.drwtNo2, data.drwtNo3,
                    data.drwtNo4, data.drwtNo5, data.drwtNo6
                ].sort((a, b) => a - b),
                bonus: data.bnusNo,
                prize: {
                    1: { 
                        count: data.firstPrzwnerCo || 0, 
                        amount: data.firstWinamnt || 0 
                    },
                    2: { 
                        count: data.secondPrzwnerCo || 0, 
                        amount: data.secondWinamnt || 0 
                    },
                    3: { 
                        count: data.thirdPrzwnerCo || 0, 
                        amount: data.thirdWinamnt || 0 
                    },
                    4: { 
                        count: data.fourthPrzwnerCo || 0, 
                        amount: data.fourthWinamnt || 50000  // ê³ ì • ê¸ˆì•¡
                    },
                    5: { 
                        count: data.fifthPrzwnerCo || 0, 
                        amount: data.fifthWinamnt || 5000    // ê³ ì • ê¸ˆì•¡
                    }
                }
            };
        }

        // ë‹¹ì²¨ ë²ˆí˜¸ í‘œì‹œ
        function displayWinningNumbers(data) {
            const container = document.getElementById('winning-numbers');
            
            // ë²ˆí˜¸ë³„ ìƒ‰ìƒ í´ë˜ìŠ¤ ê²°ì • í•¨ìˆ˜
            function getBallColorClass(num) {
                if (num >= 1 && num <= 10) return 'ball-yellow';
                if (num >= 11 && num <= 20) return 'ball-blue';
                if (num >= 21 && num <= 30) return 'ball-red';
                if (num >= 31 && num <= 40) return 'ball-gray';
                if (num >= 41 && num <= 45) return 'ball-green';
                return '';
            }
            
            container.innerHTML = `
                <div class="alert alert-info">
                    <span>ğŸ¯</span>
                    <div>
                        <strong>${data.round}íšŒì°¨ ë‹¹ì²¨ ë²ˆí˜¸</strong> (${data.date})
                        <div style="margin-top: 10px;">
                            <div class="lotto-balls" style="display: inline-flex;">
                                ${data.numbers.map(num => `
                                    <div class="lotto-ball ${getBallColorClass(num)}">${num}</div>
                                `).join('')}
                                <div style="margin: 0 10px; display: flex; align-items: center;">+</div>
                                <div class="lotto-ball ${getBallColorClass(data.bonus)}" style="position: relative;">
                                    ${data.bonus}
                                    <div style="position: absolute; top: -5px; right: -5px; background: #FFD700; color: #000; font-size: 10px; padding: 2px 4px; border-radius: 4px; font-weight: bold;">B</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ë‹¹ì²¨ ê²°ê³¼ í™•ì¸
        // ë‹¹ì²¨ ê²°ê³¼ í‘œì‹œ (êµ¬ë²„ì „ - ì‚¬ìš© ì•ˆ í•¨)
        // ì´ í•¨ìˆ˜ëŠ” displayCheckResultsEnhanced()ë¡œ ëŒ€ì²´ë˜ì—ˆìŠµë‹ˆë‹¤

        // ìµœì‹  íšŒì°¨ ì¡°íšŒ
        async function getLatestRound() {
            // ì‹¤ì œë¡œëŠ” APIë¥¼ í†µí•´ ìµœì‹  íšŒì°¨ë¥¼ ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤
            const today = new Date();
            const firstLotto = new Date('2002-12-07');
            const weeksPassed = Math.floor((today - firstLotto) / (7 * 24 * 60 * 60 * 1000));
            const latestRound = weeksPassed + 1;
            
            document.getElementById('check-round').value = latestRound;
            
            const container = document.getElementById('winning-numbers');
            container.innerHTML = `
                <div class="alert alert-success">
                    <span>âœ…</span>
                    <div>ìµœì‹  íšŒì°¨ëŠ” ì•½ ${latestRound}íšŒì°¨ì…ë‹ˆë‹¤.</div>
                </div>
            `;
        }

        // PDF ë‚´ë³´ë‚´ê¸° (2ì—´ ë ˆì´ì•„ì›ƒ)
        async function exportPDF() {
            if (currentNumbers.length === 0) {
                alert('ë¨¼ì € ë²ˆí˜¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const doc = new jsPDF();
            
            // í°íŠ¸ ì„¤ì •
            doc.setFont('helvetica');
            
            // ì œëª©
            doc.setFontSize(20);
            doc.text('Lotto Numbers', 105, 20, { align: 'center' });
            
            // ë‚ ì§œ
            doc.setFontSize(12);
            doc.text(`Generated: ${new Date().toLocaleDateString()}`, 105, 30, { align: 'center' });
            doc.text(`Total: ${currentNumbers.length} combinations`, 105, 36, { align: 'center' });
            
            // 2ì—´ ë ˆì´ì•„ì›ƒ ì„¤ì •
            doc.setFontSize(10);
            let yPos = 50;
            const leftColumnX = 20;
            const rightColumnX = 115;
            const lineHeight = 8;
            const cardHeight = 50;
            let currentColumn = 'left';
            let cardCount = 0;
            
            // 5ê°œì”© ì¹´ë“œë¡œ ë¬¶ì–´ì„œ ì¶œë ¥
            for (let i = 0; i < currentNumbers.length; i += 5) {
                const cardNumbers = currentNumbers.slice(i, i + 5);
                const xPos = currentColumn === 'left' ? leftColumnX : rightColumnX;
                
                // ì¹´ë“œ í…Œë‘ë¦¬
                doc.setDrawColor(200, 200, 200);
                doc.setLineWidth(0.5);
                doc.rect(xPos - 2, yPos - 5, 90, cardHeight);
                
                // ì¹´ë“œ íƒ€ì´í‹€
                doc.setFontSize(11);
                doc.setTextColor(79, 70, 229); // primary color
                const startNum = i + 1;
                const endNum = Math.min(i + 5, currentNumbers.length);
                doc.text(`Set ${startNum}-${endNum}`, xPos, yPos);
                
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(10);
                
                // ë²ˆí˜¸ ì¶œë ¥
                let cardYPos = yPos + 8;
                cardNumbers.forEach((numbers, index) => {
                    const setNum = (i + index + 1).toString().padStart(2, '0');
                    const numbersText = numbers.map(n => n.toString().padStart(2, '0')).join('  ');
                    doc.text(`${setNum}.  ${numbersText}`, xPos + 2, cardYPos);
                    cardYPos += lineHeight;
                });
                
                // ë‹¤ìŒ ìœ„ì¹˜ ê³„ì‚°
                cardCount++;
                if (currentColumn === 'left') {
                    currentColumn = 'right';
                } else {
                    currentColumn = 'left';
                    yPos += cardHeight + 10;
                }
                
                // í˜ì´ì§€ ë„˜ê¹€ ì²´í¬
                if (yPos > 250 && currentColumn === 'left') {
                    doc.addPage();
                    yPos = 20;
                }
            }
            
            // ì €ì¥
            doc.save(`lotto_numbers_${new Date().getTime()}.pdf`);
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStatistics() {
            document.getElementById('total-generated').textContent = statistics.generated;
            document.getElementById('total-saved').textContent = statistics.saved;
            document.getElementById('total-checked').textContent = statistics.checked;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.onload = function() {
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
            const savedToken = localStorage.getItem('github-token');
            const savedOwner = localStorage.getItem('github-owner');
            const savedRepo = localStorage.getItem('github-repo');
            
            if (savedToken) document.getElementById('github-token').value = savedToken;
            if (savedOwner) document.getElementById('github-owner').value = savedOwner;
            if (savedRepo) document.getElementById('github-repo').value = savedRepo;
            
            // ì„¤ì • ì €ì¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('github-token').addEventListener('change', (e) => {
                localStorage.setItem('github-token', e.target.value);
            });
            document.getElementById('github-owner').addEventListener('change', (e) => {
                localStorage.setItem('github-owner', e.target.value);
            });
            document.getElementById('github-repo').addEventListener('change', (e) => {
                localStorage.setItem('github-repo', e.target.value);
            });
            
            updateStatistics();
        };
    </script>
</body>
</html>